# ä»æµè§ˆå™¨è·å–çœŸå®è¯·æ±‚å¤´ï¼ˆå®Œæ•´æ•™ç¨‹ï¼‰

## ğŸ¯ ç›®æ ‡

è·å–å°çº¢ä¹¦æœç´¢APIçš„**å®Œæ•´çœŸå®è¯·æ±‚å¤´**ï¼ŒåŒ…æ‹¬ï¼š
- âœ… å®Œæ•´Cookieï¼ˆå« `web_session`ï¼‰
- âœ… `x-s-common`ï¼ˆå…³é”®é˜²çˆ¬å­—æ®µï¼‰
- âœ… `x-b3-traceid` / `x-xray-traceid`
- âœ… æ‰€æœ‰å…¶ä»–è¯·æ±‚å¤´

---

## ğŸ“‹ æ­¥éª¤1ï¼šæ‰“å¼€Chromeå¼€å‘è€…å·¥å…·

1. æ‰“å¼€Chromeæµè§ˆå™¨
2. è®¿é—® https://www.xiaohongshu.com
3. **ç¡®ä¿å·²ç™»å½•**ï¼ˆæ‰«ç æˆ–æ‰‹æœºå·ç™»å½•ï¼‰
4. æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·
5. åˆ‡æ¢åˆ° **`Network`** æ ‡ç­¾

---

## ğŸ“‹ æ­¥éª¤2ï¼šå‡†å¤‡æŠ“åŒ…

1. **å‹¾é€‰ `Preserve log`**ï¼ˆä¿ç•™æ—¥å¿—ï¼‰
   - ä½ç½®ï¼šNetworkæ ‡ç­¾é¡¶éƒ¨
   - ä½œç”¨ï¼šé˜²æ­¢é¡µé¢è·³è½¬æ—¶æ¸…ç©ºè¯·æ±‚è®°å½•

2. **ç‚¹å‡» `Clear`**ï¼ˆæ¸…ç©ºï¼‰
   - ä½ç½®ï¼šNetworkæ ‡ç­¾å·¦ä¸Šè§’çš„ğŸš«å›¾æ ‡
   - ä½œç”¨ï¼šæ¸…ç©ºä¹‹å‰çš„è¯·æ±‚ï¼Œæ–¹ä¾¿æŸ¥æ‰¾

3. **ç­›é€‰å™¨è®¾ç½®ä¸º `Fetch/XHR`**
   - ä½ç½®ï¼šNetworkæ ‡ç­¾ä¸‹æ–¹çš„ç­›é€‰æŒ‰é’®
   - ä½œç”¨ï¼šåªæ˜¾ç¤ºAPIè¯·æ±‚ï¼Œéšè—å›¾ç‰‡/CSSç­‰

---

## ğŸ“‹ æ­¥éª¤3ï¼šè§¦å‘æœç´¢è¯·æ±‚

1. åœ¨å°çº¢ä¹¦æœç´¢æ¡†ä¸­è¾“å…¥ **`ç¾é£Ÿ`**
2. æŒ‰ `Enter` æˆ–ç‚¹å‡»æœç´¢æŒ‰é’®
3. ç­‰å¾…æœç´¢ç»“æœåŠ è½½å®Œæˆ

---

## ğŸ“‹ æ­¥éª¤4ï¼šæ‰¾åˆ°ç›®æ ‡è¯·æ±‚

åœ¨Networké¢æ¿ä¸­ï¼ŒæŸ¥æ‰¾åä¸ºï¼š
```
search/notes
```

**å®Œæ•´URL**ï¼š
```
https://edith.xiaohongshu.com/api/sns/web/v1/search/notes
```

**ç‰¹å¾**ï¼š
- âœ… Method: `POST`
- âœ… Status: `200`
- âœ… Type: `xhr` æˆ– `fetch`

---

## ğŸ“‹ æ­¥éª¤5ï¼šå¤åˆ¶å®Œæ•´Cookie

1. **ç‚¹å‡»** `search/notes` è¯·æ±‚
2. å³ä¾§é¢æ¿åˆ‡æ¢åˆ° **`Headers`** æ ‡ç­¾
3. å‘ä¸‹æ»šåŠ¨åˆ° **`Request Headers`** éƒ¨åˆ†
4. æ‰¾åˆ° **`Cookie:`** å­—æ®µ
5. **å³é”® â†’ `Copy value`**

**Cookieç¤ºä¾‹**ï¼š
```
abRequestId=xxx; xsecappid=xhs-pc-web; a1=xxx; webId=xxx; gid=xxx; 
web_session=040069b9xxx; websectiga=xxx; sec_poison_id=xxx; ...
```

**âš ï¸ å…³é”®æ£€æŸ¥**ï¼š
- å¿…é¡»åŒ…å« `web_session=`
- é•¿åº¦åº”è¯¥åœ¨ 1000+ å­—ç¬¦

---

## ğŸ“‹ æ­¥éª¤6ï¼šå¤åˆ¶æ‰€æœ‰å…³é”®è¯·æ±‚å¤´

### æ–¹æ³•Aï¼šé€ä¸ªå¤åˆ¶ï¼ˆæ¨èåˆå­¦è€…ï¼‰

åœ¨ `Request Headers` ä¸­ï¼Œå¤åˆ¶ä»¥ä¸‹å­—æ®µï¼š

| å­—æ®µå | ä½œç”¨ | ç¤ºä¾‹ |
|--------|------|------|
| `Cookie` | è®¤è¯ä¿¡æ¯ | `a1=xxx; web_session=xxx; ...` |
| `x-s` | ç­¾åï¼ˆä¸»ï¼‰ | `XYS_2UQhPsHCH0c1Pjh9...` |
| `x-t` | æ—¶é—´æˆ³ | `1763538131335` |
| `x-s-common` | ç­¾åï¼ˆè¾…åŠ©ï¼‰â­ | `2UQAPsHC...` |
| `x-b3-traceid` | é“¾è·¯è¿½è¸ª | `b4f2a1c3d5e6f7a8` |
| `x-xray-traceid` | é“¾è·¯è¿½è¸ª | `9d8e7f6c5b4a3210...` |
| `User-Agent` | æµè§ˆå™¨æ ‡è¯† | `Mozilla/5.0 ...` |
| `Referer` | æ¥æºé¡µé¢ | `https://www.xiaohongshu.com/` |
| `Content-Type` | å†…å®¹ç±»å‹ | `application/json` |

### æ–¹æ³•Bï¼šä¸€é”®å¤åˆ¶æ‰€æœ‰ï¼ˆæ¨èé«˜çº§ï¼‰

1. åœ¨ `Request Headers` éƒ¨åˆ†
2. æ‰¾åˆ°é¡¶éƒ¨çš„ **`view source`** é“¾æ¥ï¼Œç‚¹å‡»
3. å…¨é€‰æ‰€æœ‰æ–‡æœ¬ï¼ˆ`Ctrl+A`ï¼‰
4. å¤åˆ¶ï¼ˆ`Ctrl+C`ï¼‰

---

## ğŸ“‹ æ­¥éª¤7ï¼šå¤åˆ¶è¯·æ±‚Body

1. åœ¨åŒä¸€ä¸ª `search/notes` è¯·æ±‚ä¸­
2. åˆ‡æ¢åˆ° **`Payload`** æ ‡ç­¾
3. é€‰æ‹© **`view source`**
4. å¤åˆ¶JSONå†…å®¹

**è¯·æ±‚Bodyç¤ºä¾‹**ï¼š
```json
{
  "keyword": "ç¾é£Ÿ",
  "page": 1,
  "page_size": 20,
  "search_id": "2flzo7d3dchj27fy2alpz",
  "sort": "general",
  "note_type": 0
}
```

---

## ğŸ“‹ æ­¥éª¤8ï¼šä¿å­˜åˆ°æ–‡ä»¶

åˆ›å»ºæ–‡ä»¶ `captured_request.json`ï¼š

```json
{
  "url": "https://edith.xiaohongshu.com/api/sns/web/v1/search/notes",
  "method": "POST",
  "headers": {
    "Content-Type": "application/json",
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36",
    "Referer": "https://www.xiaohongshu.com/",
    "Cookie": "ä½ å¤åˆ¶çš„å®Œæ•´Cookie",
    "x-s": "XYS_2UQhPsHCH0c1Pjh9...",
    "x-t": "1763538131335",
    "x-s-common": "2UQAPsHC...",
    "x-b3-traceid": "b4f2a1c3d5e6f7a8",
    "x-xray-traceid": "9d8e7f6c5b4a3210..."
  },
  "body": {
    "keyword": "ç¾é£Ÿ",
    "page": 1,
    "page_size": 20,
    "sort": "general",
    "note_type": 0
  }
}
```

---

## ğŸ§ª æ­¥éª¤9ï¼šéªŒè¯Cookieå®Œæ•´æ€§

è¿è¡Œä»¥ä¸‹Pythonè„šæœ¬ï¼š

```python
cookie = "ä½ å¤åˆ¶çš„Cookie"

required_fields = [
    "a1",
    "webId",
    "web_session",  # æœ€å…³é”®ï¼
    "xsecappid",
    "websectiga",
    "sec_poison_id"
]

for field in required_fields:
    if f"{field}=" in cookie:
        print(f"âœ… {field}")
    else:
        print(f"âŒ {field} ç¼ºå¤±ï¼")
```

---

## âœ… å®Œæˆï¼

ç°åœ¨ä½ å·²ç»è·å–äº†å®Œæ•´çš„çœŸå®è¯·æ±‚ä¿¡æ¯ï¼Œå¯ä»¥ç”¨æ¥ï¼š
1. åˆ†æ `x-s-common` çš„ç”Ÿæˆé€»è¾‘
2. æ›´æ–°æµ‹è¯•è„šæœ¬ï¼Œä½¿ç”¨çœŸå®çš„è¯·æ±‚å¤´
3. å¯¹æ¯”æˆ‘ä»¬çš„ç­¾åæœåŠ¡æ˜¯å¦ç¼ºå°‘å…³é”®å­—æ®µ

---

## ğŸ” å¸¸è§é—®é¢˜

### Q1: æ‰¾ä¸åˆ° `x-s-common` å­—æ®µï¼Ÿ

**A**: å¯èƒ½åŸå› ï¼š
- æµè§ˆå™¨è¯·æ±‚ä½¿ç”¨äº†ä¸åŒçš„APIç‰ˆæœ¬
- å°çº¢ä¹¦æ›´æ–°äº†é˜²çˆ¬ç­–ç•¥
- ä½ çš„è´¦å·ç­‰çº§ä¸éœ€è¦ `x-s-common`

**è§£å†³**ï¼šå°è¯•æœç´¢ä¸åŒçš„å…³é”®è¯ï¼Œå¤šæŠ“å‡ æ¬¡åŒ…ã€‚

---

### Q2: `web_session` åœ¨ `document.cookie` ä¸­æ‰¾ä¸åˆ°ï¼Ÿ

**A**: è¿™æ˜¯æ­£å¸¸çš„ï¼`web_session` æ˜¯ **HttpOnly Cookie**ï¼ŒJavaScriptæ— æ³•è®¿é—®ã€‚
å¿…é¡»ä»Networké¢æ¿çš„ `Request Headers` ä¸­å¤åˆ¶ã€‚

---

### Q3: å¤åˆ¶çš„Cookieå¾ˆé•¿ï¼Œæœ‰ä¸Šåƒä¸ªå­—ç¬¦ï¼Ÿ

**A**: å®Œå…¨æ­£å¸¸ï¼å®Œæ•´çš„Cookieé€šå¸¸åŒ…å«å‡ åä¸ªå­—æ®µï¼Œæ€»é•¿åº¦1000-3000å­—ç¬¦å¾ˆå¸¸è§ã€‚

---

### Q4: æˆ‘æƒ³ç”¨curlæµ‹è¯•æ€ä¹ˆåŠï¼Ÿ

**A**: åœ¨Networké¢æ¿ä¸­ï¼š
1. å³é”®ç‚¹å‡» `search/notes` è¯·æ±‚
2. `Copy` â†’ `Copy as cURL (bash)`
3. ç²˜è´´åˆ°ç»ˆç«¯å³å¯è¿è¡Œ

---

## ğŸ¯ ä¸‹ä¸€æ­¥

å°†è·å–çš„çœŸå®è¯·æ±‚å¤´å‘ç»™æˆ‘ï¼Œæˆ‘ä»¬ä¸€èµ·åˆ†æï¼š
1. æ˜¯å¦å­˜åœ¨ `x-s-common`
2. `x-b3-traceid` / `x-xray-traceid` çš„çœŸå®æ ¼å¼
3. è¿˜æœ‰å“ªäº›æˆ‘ä»¬é—æ¼çš„å…³é”®å­—æ®µ

è®©æˆ‘ä»¬ä¸€èµ·ç ´è§£å°çº¢ä¹¦çš„é˜²çˆ¬ç³»ç»Ÿï¼ğŸ’ª







